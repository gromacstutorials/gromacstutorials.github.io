<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Solvation energy" href="../level3/solvation-energy.html" /><link rel="prev" title="Protein in electrolyte" href="../level1/protein-in-electrolyte.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Stretching a polymer - </title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8b1a507d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Main</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/contact.html">Contact us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorial1/bulk-solution.html">Bulk salt solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level1/protein-in-electrolyte.html">Protein in electrolyte</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Stretching a polymer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level3/solvation-energy.html">Solvation energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level3/adsorption-ethanol.html">Free energy profile</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/extra/create-GRO-python.html">Write topology using Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alternative</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/lammps.html">Use LAMMPS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/tutorials/level2/stretching-a-polymer.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="stretching-a-polymer">
<span id="stretching-polymer-label"></span><h1>Stretching a polymer<a class="headerlink" href="#stretching-a-polymer" title="Link to this heading">¶</a></h1>
<div class="hatnote docutils container">
<p>Solvating and stretching a small polymer molecule</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/video-PEG-dark.webp"><img alt="Movie of a peg polymer molecule in water as simulated with GROMACS" class="only-dark" src="../../_images/video-PEG-dark.webp" style="height: 250px;" />
</a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/video-PEG-light.webp"><img alt="Movie of a peg polymer molecule in water as simulated with GROMACS" class="only-light" src="../../_images/video-PEG-light.webp" style="height: 250px;" />
</a>
</figure>
<p>The goal of this tutorial is to use GROMACS and solvate a small
hydrophilic polymer in a reservoir of water.</p>
<p>An all-atom description is used for both polymer and water. The polymer is
PolyEthylene Glycol (PEG). Once the system is properly
equilibrated at the desired temperature and pressure, a force is applied
to both ends of the polymer. The evolution of the polymer length
is measured, and the energetics of the system is measured.</p>
<div class="justify docutils container">
<p>If you are completely new to GROMACS, I recommend that
you follow this tutorial on a simple <a class="reference internal" href="../tutorial1/bulk-solution.html#bulk-solution-label"><span class="std std-ref">Bulk salt solution</span></a> first.</p>
</div>
<div class="patreon admonition">
<p class="admonition-title">Struggling with your molecular simulations project?</p>
<p>Get guidance for your GROMACS simulations. <a class="reference internal" href="../../non-tutorials/contact.html#contact-label"><span class="std std-ref">Contact us</span></a> for
personalized <a href="https://www.patreon.com/molecularsimulations" target="_blank">advice</a> for your project.</p>
</div>
<div class="version docutils container">
<p>This tutorial is compatible with the 2024.2 GROMACS version.</p>
</div>
<section id="prepare-the-peg-molecule">
<h2>Prepare the PEG molecule<a class="headerlink" href="#prepare-the-peg-molecule" title="Link to this heading">¶</a></h2>
<p>Download the <em>peg.gro</em> file for the PEG molecule by clicking <a href="https://raw.githubusercontent.com/gromacstutorials/gromacstutorials-inputs/main/level2/stretching-a-polymer/cubic-box/peg.gro" target="_blank">here</a>.
The <em>peg.gro</em> file can be visualized using vmd, by typing in a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>peg.gro
</pre></div>
</div>
<figure class="align-default">
<a class="only-light reference internal image-reference" href="../../_images/light-PEG.png"><img alt="PEG polymer for molecular dynamics simulation in GROMACS" class="only-light" src="../../_images/light-PEG.png" style="width: 500px;" />
</a>
</figure>
<figure class="align-default">
<a class="only-dark reference internal image-reference" href="../../_images/dark-PEG.png"><img alt="PEG polymer for molecular dynamics simulation in GROMACS" class="only-dark" src="../../_images/dark-PEG.png" style="width: 500px;" />
</a>
</figure>
<div class="figurelegend docutils container">
<p>Figure: The PEG molecule is a polymer chain made of carbon atoms (in gray),
oxygen atoms (in red), and hydrogen atoms (in white). See
the corresponding <a href="https://www.youtube.com/watch?v=8ldIHP175TI&t=9s" target="_blank">video</a>.</p>
</div>
<p>Save <em>peg.gro</em> in a new folder. Next to <em>peg.gro</em> create an empty
file named <em>topol.top</em>, and copy the following lines in it:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>[ defaults ]
; nbfunc    comb-rule       gen-pairs       fudgeLJ fudgeQQ
  1         1           no          1.0     1.0

; Include forcefield parameters
#include &quot;ff/charmm35r.itp&quot;
#include &quot;ff/peg.itp&quot;
#include &quot;ff/tip3p.itp

[ system ]
; Name
  PEG

[ molecules ]
; Compound        #mols
  PEG             1
</pre></div>
</div>
<p>Next to <em>conf.gro</em> and <em>topol.top</em>, create a folder named <em>ff/</em>, and copy
the following 3 <em>.itp</em> files into it: <a href="https://raw.githubusercontent.com/gromacstutorials/gromacstutorials-inputs/main/level2/stretching-a-polymer/cubic-box/ff/charmm35r.itp" target="_blank">charmm35r.itp</a>, <a href="https://raw.githubusercontent.com/gromacstutorials/gromacstutorials-inputs/main/level2/stretching-a-polymer/cubic-box/ff/peg.itp" target="_blank">peg.itp</a>,
and <a href="https://raw.githubusercontent.com/gromacstutorials/gromacstutorials-inputs/main/level2/stretching-a-polymer/cubic-box/ff/tip3p.itp" target="_blank">tip3p.itp</a>.</p>
<p>These 3 files contain the parameters for the PEG and the water molecules
with oxygen (OW) and hydrogen (HW) atoms.</p>
<p>Create an <em>inputs/</em> folder next to <em>ff/</em>, and create a new empty file
called <em>em.mdp</em>. Copy the following lines into it:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>integrator = steep
emtol = 10
emstep = 0.0001
nsteps = 5000

nstenergy = 1000
nstxout = 100

cutoff-scheme = Verlet
coulombtype = PME
rcoulomb = 1
rvdw = 1
pbc = xyz
</pre></div>
</div>
<p>Most of these commands have been seen in previous tutorials. The most
important command is <em>integrator = steep</em>, which set the algorithm
used by GROMACS as the steepest-descent,
which moves the atoms following the direction of the largest forces
until one of the stopping criteria is reached <span id="id1">[<a class="reference internal" href="../../non-tutorials/bibliography.html#id47" title="Peter Debye. Näherungsformeln für die zylinderfunktionen für große werte des arguments und unbeschränkt veränderliche werte des index. Mathematische Annalen, 67(4):535–558, 1909.">14</a>]</span>.</p>
<p>Run the energy minimization using GROMACS by typing in a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/em.mdp<span class="w"> </span>-c<span class="w"> </span>peg.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>em-peg
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>em-peg<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>The <em>-nt 8</em> option limits the number of threads that GROMACS uses. Adjust
the number to your computer.</p>
<p>After the simulation is over, open the trajectory file with VMD by typing
in a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>peg.gro<span class="w"> </span>em-peg.trr
</pre></div>
</div>
<p>From VMD, the PEG molecule can be seen moving a little by the
steepest-descent algorithm.</p>
<p>Before adding the water, let us reshape the box and recenter the PEG molecule
in the box. As a first step, let us use a cubic box of
lateral size <span class="math notranslate nohighlight">\(2.6~\text{nm}\)</span>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>trjconv<span class="w"> </span>-f<span class="w"> </span>em-peg.gro<span class="w"> </span>-s<span class="w"> </span>em-peg.tpr<span class="w"> </span>-o<span class="w"> </span>peg-recentered.gro<span class="w"> </span>-center<span class="w"> </span>-pbc<span class="w"> </span>mol<span class="w"> </span>-box<span class="w"> </span><span class="m">2</span>.6<span class="w"> </span><span class="m">2</span>.6<span class="w"> </span><span class="m">2</span>.6
</pre></div>
</div>
<p>Select <em>system</em> for both centering and output. The newly created <em>gro</em>
file named <em>peg-recentered.gro</em> will be used as a starting point
for the next step of the tutorial.</p>
</section>
<section id="solvate-the-peg-molecule">
<h2>Solvate the PEG molecule<a class="headerlink" href="#solvate-the-peg-molecule" title="Link to this heading">¶</a></h2>
<p>Let us add the water molecules to the system by using <em>gmx solvate</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>solvate<span class="w"> </span>-cp<span class="w"> </span>peg-recentered.gro<span class="w"> </span>-cs<span class="w"> </span>spc216.gro<span class="w"> </span>-o<span class="w"> </span>peg-solvated.gro<span class="w"> </span>-p<span class="w"> </span>topol.top
</pre></div>
</div>
<p>Here <em>spc216.gro</em> is a default GROMACS file containing a pre-equilibrated
water reservoir.</p>
<p>The newly created file <em>peg-solvated.gro</em> contains the water molecules,
and a a new line in was added to the topology file <em>topol.top</em>:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>[ molecules ]
; Compound        #mols
PEG               1
SOL               546
</pre></div>
</div>
<p>We can apply the same energy minimization to the newly created solvated
system. Simply add the following line to <em>em.mdp</em>:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>define = -DFLEXIBLE
</pre></div>
</div>
<p>And then launch the energy minimization again using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/em.mdp<span class="w"> </span>-c<span class="w"> </span>peg-solvated.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>em
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>em<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>The <em>define = -DFLEXIBLE</em> option triggers the following <em>if</em> condition
within the <em>tip3p.itp</em> file:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>#ifdef FLEXIBLE
[ bonds ]
; i     j       funct   length  force.c.
1       2       1       0.09572 502416.0 0.09572        502416.0
1       3       1       0.09572 502416.0 0.09572        502416.0

[ angles ]
; i      j      k       funct   angle   force.c.
2        1      3       1       104.52  628.02  104.52  628.02
</pre></div>
</div>
<p>With this <em>if</em> condition the water molecules
behave as flexible. This is better because rigid molecules and
energy minimization usually don’t go along well. For the next molecular
dynamics steps, rigid water molecules will be used by not including
the <em>define = -DFLEXIBLE</em> command in the inputs.</p>
</section>
<section id="equilibrate-the-peg-water-system">
<h2>Equilibrate the PEG-water system<a class="headerlink" href="#equilibrate-the-peg-water-system" title="Link to this heading">¶</a></h2>
<p>Let use equilibrate the system in two steps: first a NVT simulation,
with constant number of particles, constant volume, and imposed temperature,
and second a NPT simulation with imposed pressure.</p>
<p>Within the <em>inputs/</em> folder, create a new input named <em>nvt-peg-h2o.mdp</em>,
and copy the following lines into it:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>integrator = md
dt = 0.002
nsteps = 10000

nstenergy = 500
nstlog = 500
nstxout-compressed = 500

constraint-algorithm = lincs
constraints = hbonds
continuation = no

coulombtype = pme
rcoulomb = 1.0
rlist = 1.0

vdwtype = Cut-off
rvdw = 1.0

tcoupl = v-rescale
tau_t = 0.1 0.1
ref_t = 300 300
tc_grps = PEG Water

gen-vel = yes
gen-temp = 300
gen-seed = 65823

comm-mode = linear
comm-grps = PEG
</pre></div>
</div>
<p>Most of these commands have already been seen. In addition to the conventional
<em>md</em> leap-frog algorithm integrator, long-range Coulomb and short-range
van der Waals interactions, the LINCS constraint algorithm is used to maintain
the hydrogen bonds as rigid. An initial temperature of <span class="math notranslate nohighlight">\(300~K\)</span> is given
to the system by the <em>gen-</em> commands, and the PEG is maintained in the center
of the box by the <em>comm-mode</em> and <em>comm-grps</em> commands.</p>
<p>Launch the NVT simulation using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/nvt-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>em.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>nvt<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>nvt<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>The <em>maxwarn 1</em> option is used to avoid a GROMACS WARNING related to the
centering of the PEG in the box.</p>
<p>Let us follow-up with the NPT equilibration. Duplicate the <em>nvt-peg-h2o.mdp</em>
file into a new input file named <em>npt-peg-h2o.mdp</em>. Within <em>npt-peg-h2o.mdp</em>,
Within the <em>npt-peg-h2o.mdp</em>, delete the lines related to the creation
of velocity as its better to keep the velocities generated during the
NVT run:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>gen_vel = yes
gen-temp = 300
gen-seed = 65823
</pre></div>
</div>
<p>In addition to the removal the previous 3 lines, add the following lines
to <em>npt-peg-h2o.mdp</em> to specify the isotropic barostat with imposed pressure
of <span class="math notranslate nohighlight">\(1~\text{bar}\)</span>:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>pcoupl = c-rescale
pcoupltype = isotropic
tau-p = 0.5
ref-p = 1.0
compressibility = 4.5e-5
</pre></div>
</div>
<p>Run the NPT simulation, using the final state of the NVT simulation
<em>nvt.gro</em> as starting configuration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="si">${</span><span class="nv">gmx</span><span class="si">}</span><span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/npt-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>nvt.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>npt<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
<span class="si">${</span><span class="nv">gmx</span><span class="si">}</span><span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>npt<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>Let us observe the evolution of the potential energy of the system during the
3 successive equilibration steps, i.e. the <em>em</em>, <em>nvt</em>, and <em>npt</em> steps,
using the <em>gmx energy</em> command as follow:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>energy<span class="w"> </span>-f<span class="w"> </span>em.edr<span class="w"> </span>-o<span class="w"> </span>energy-em.xvg
gmx<span class="w"> </span>energy<span class="w"> </span>-f<span class="w"> </span>nvt.edr<span class="w"> </span>-o<span class="w"> </span>energy-nvt.xvg
gmx<span class="w"> </span>energy<span class="w"> </span>-f<span class="w"> </span>npt.edr<span class="w"> </span>-o<span class="w"> </span>energy-npt.xvg
</pre></div>
</div>
<p>For each of the 3 <em>gmx energy</em> commands, select <em>potential</em>.</p>
<figure class="align-default">
<img alt="Potential energy from molecular dynamics simulation in GROMACS" class="only-light" src="../../_images/potential-energy-light.png" />
</figure>
<figure class="align-default">
<img alt="Potential energy from molecular dynamics simulation in GROMACS" class="only-dark" src="../../_images/potential-energy-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Evolution of the potential energy during the 3 equilibration steps,
respectively the energy minimization (a), the NVT step (b), and the NPT
step (c).</p>
</div>
<p>Let us launch a longer simulation, and extract the angle distribution
between the different atoms of the PEG molecules. This angle
distribution will be used later as a benchmark to probe the effect of
of the stretching on the PEG structure.</p>
<p>Create a new input named <em>production-peg-h2o.mdp</em>, and copy the following
lines into it:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>integrator = md
dt = 0.002
nsteps = 50000

nstenergy = 100
nstlog = 100
nstxout-compressed = 100

constraint-algorithm = lincs
constraints = hbonds
continuation = no

coulombtype = pme
rcoulomb = 1.0
rlist = 1.0

vdwtype = Cut-off
rvdw = 1.0

tcoupl = v-rescale
tau_t = 0.1 0.1
ref_t = 300 300
tc_grps = PEG Water

comm-mode = linear
comm-grps = PEG
</pre></div>
</div>
<p>This script resembles the <em>nvt-peg-h2o.mdp</em> input, but the duration and
output frequency is different, and without the <em>gen-vel</em> commands.</p>
<p>Run it using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/production-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>npt.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>production<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>production<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>First, create an index file called <em>angle.ndx</em> using the <em>gmx mk_angndx</em>
command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mk_angndx<span class="w"> </span>-s<span class="w"> </span>production.tpr<span class="w"> </span>-hyd<span class="w"> </span>no
</pre></div>
</div>
<p>The <em>angle.ndx</em> file generated contains groups with all the atoms
involved by an angle constraint, with the exception of the hydrogen
atoms due to the use of <em>-hyd no</em>. The atom ids selected in the groups
can be seen from the <em>index.ndx</em> file:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>[ Theta=109.7_795.49 ]
    2     5     7    10    12    14    17    19    21    24    26    28
    31    33    35    38    40    42    45    47    49    52    54    56
    59    61    63    66    68    70    73    75    77    80    82    84
</pre></div>
</div>
<p>Here, each number corresponds to the atom index, as can be seen from the
initial <em>peg.gro</em> file. For instance, the atom of <em>id 2</em> is a carbon atom,
and the atom with <em>id 5</em> is an oxygen:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>PEG in water
86
    1PEG      H    1   2.032   1.593   1.545  0.6568  2.5734  1.2192
    1PEG      C    2   1.929   1.614   1.508  0.1558 -0.2184  0.8547
    1PEG     H1    3   1.902   1.721   1.523 -3.6848 -0.3932 -3.0658
    1PEG     H2    4   1.921   1.588   1.400 -1.5891  1.4960  0.5057
    1PEG      O    5   1.831   1.544   1.576  0.0564 -0.5300 -0.6094
    1PEG     H3    6   1.676   1.665   1.494 -2.6585 -0.5997  0.3128
    1PEG     C1    7   1.699   1.559   1.519  0.6996  0.0066  0.2900
    1PEG     H4    8   1.699   1.500   1.425  4.2893  1.6837 -0.9462
(...)
</pre></div>
</div>
<p>Then, extract the angle distribution from the <em>production.xtc</em>
file using <em>gmx angle</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>angle<span class="w"> </span>-n<span class="w"> </span>angle.ndx<span class="w">  </span>-f<span class="w"> </span>production.xtc<span class="w"> </span>-od<span class="w"> </span>angle-distribution.xvg<span class="w"> </span>-binwidth<span class="w"> </span><span class="m">0</span>.25
</pre></div>
</div>
<p>Select 1 for the O-C-C-O dihedral.</p>
<figure class="align-default">
<img alt="Angular distribution from molecular dynamics simulation in GROMACS" class="only-light" src="../../_images/dihedral-distribution-light.png" />
</figure>
<figure class="align-default">
<img alt="Angular distribution from molecular dynamics simulation in GROMACS" class="only-dark" src="../../_images/dihedral-distribution-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Angular distribution for the O-C-C-O dihedral of the PEG molecules.</p>
</div>
</section>
<section id="stretch-on-the-polymer">
<h2>Stretch on the polymer<a class="headerlink" href="#stretch-on-the-polymer" title="Link to this heading">¶</a></h2>
<p>Create a new folder named <em>elongated-box/</em> next to <em>cubic-box/</em>, and copy
<em>ff/</em>, <em>inputs/</em>, <em>em-peg.gro</em>, and em-peg.tpr from <em>cubic-box/</em>
into <em>elongated-box/</em>:</p>
<p>To leave space for the stretched PEG molecule, let us create an
elongated box of length <span class="math notranslate nohighlight">\(6~\text{nm}\)</span>
along the <em>x</em> direction:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>trjconv<span class="w"> </span>-f<span class="w"> </span>em-peg.gro<span class="w"> </span>-s<span class="w"> </span>em-peg.tpr<span class="w"> </span>-o<span class="w"> </span>peg-elongated.gro<span class="w"> </span>-center<span class="w"> </span>-pbc<span class="w"> </span>mol<span class="w"> </span>-box<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span>.6<span class="w"> </span><span class="m">2</span>.6
</pre></div>
</div>
<p>Select <em>system</em> for both centering and output.</p>
<p>Then, follow the exact same steps as previously to solvate and equilibrate
the system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>solvate<span class="w"> </span>-cp<span class="w"> </span>peg-elongated.gro<span class="w"> </span>-cs<span class="w"> </span>spc216.gro<span class="w"> </span>-o<span class="w"> </span>peg-solvated.gro<span class="w"> </span>-p<span class="w"> </span>topol.top

gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/em.mdp<span class="w"> </span>-c<span class="w"> </span>peg-solvated.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>em<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>em<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>

gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/nvt-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>em.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>nvt<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>nvt<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>

gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/npt-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>nvt.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>npt<span class="w"> </span>-maxwarn<span class="w"> </span><span class="m">1</span>
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>npt<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<section id="the-index-file">
<h3>The index file<a class="headerlink" href="#the-index-file" title="Link to this heading">¶</a></h3>
<p>To apply a forcing to the ends of the PEG, one needs to create atom groups.
Specificaly, we want to create two groups, each containing a single oxygen
atom from the edges of the PEG molecules (with ID 82 and 5). In GROMACS,
this can be done using and index file <em>.ndx</em>. Create a new index file
named <em>index.ndx</em> using the <em>gmx make_ndx</em> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>make_ndx<span class="w"> </span>-f<span class="w"> </span>nvt.gro<span class="w"> </span>-o<span class="w"> </span>index.ndx
</pre></div>
</div>
<p>When prompted, type the following 4 lines to create 2 additional groups:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a<span class="w"> </span><span class="m">82</span>
a<span class="w"> </span><span class="m">5</span>
name<span class="w"> </span><span class="m">6</span><span class="w"> </span>End1
name<span class="w"> </span><span class="m">7</span><span class="w"> </span>End2
</pre></div>
</div>
<p>Then, type <em>q</em> for quitting. The index file <em>index.ndx</em>
contains 2 additional groups named <em>End1</em> and <em>End2</em>:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>(...)
[ PEG ]
1    2    3    4    5    6    7    8    9   10   11   12   13   14   15
16   17   18   19   20   21   22   23   24   25   26   27   28   29   30
31   32   33   34   35   36   37   38   39   40   41   42   43   44   45
46   47   48   49   50   51   52   53   54   55   56   57   58   59   60
61   62   63   64   65   66   67   68   69   70   71   72   73   74   75
76   77   78   79   80   81   82   83   84   85   86
[ End1 ]
82
[ End2 ]
5
</pre></div>
</div>
</section>
<section id="the-input-file">
<h3>The input file<a class="headerlink" href="#the-input-file" title="Link to this heading">¶</a></h3>
<p>Let us create an input file for the stretching of the PEG molecule.</p>
<p>Create a new input file named <em>stretching-peg-h2o.mdp</em> within <em>inputs/</em>,
and copy the following lines in it:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>integrator = md
dt = 0.002
nsteps = 50000

nstenergy = 100
nstlog = 100
nstxout-compressed = 100

constraint-algorithm = lincs
constraints = hbonds
continuation = no

coulombtype = pme
rcoulomb = 1.0
rlist = 1.0

vdwtype = Cut-off
rvdw = 1.0

tcoupl = v-rescale
tau_t = 0.1 0.1
ref_t = 300 300
tc_grps = PEG Water
</pre></div>
</div>
<p>So far, the script is similar to the previously created <em>production-peg-h2o.mdp</em>
file, but without the <em>comm-mode</em> commands. To apply the constant forcing to
the <em>End1</em> and <em>End2</em> groups, add the following lines to <em>production-peg-h2o.mdp</em>:</p>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>pull = yes
pull-coord1-type = constant-force
pull-ncoords = 1
pull-ngroups = 2
pull-group1-name = End1
pull-group2-name = End2
pull-coord1-groups = 1 2
pull-coord1-geometry = direction-periodic
pull-coord1-dim = Y N N
pull-coord1-vec = 1 0 0
pull-coord1-k = 200
pull-coord1-start = yes
pull-print-com = yes
</pre></div>
</div>
<p>The force constant is requested along the <em>x</em> direction only (Y N N),
with a force constant <span class="math notranslate nohighlight">\(k = 200~\text{kJ}~\text{mol}^{-1}~\text{nm}^{-1}\)</span>.</p>
<p>Launch the simulation using the <em>-n index.ndx</em> option for the <em>gmx grompp</em>
command to refer to the previously created index file, so that GROMACS
finds the <em>End1</em> and <em>End2</em> groups.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>inputs/stretching-peg-h2o.mdp<span class="w"> </span>-c<span class="w"> </span>npt.gro<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>stretching<span class="w"> </span>-n<span class="w"> </span>index.ndx
gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>stretching<span class="w"> </span>-v<span class="w"> </span>-nt<span class="w"> </span><span class="m">8</span>
</pre></div>
</div>
<p>Two data files named <em>stretching_pullf.xvg</em> and <em>stretching_pullx.xvg</em>
are created during the simulation, and contain respectively the
force and distance between the 2 groups <em>End1</em> and <em>End2</em> as a function
of time.</p>
<figure class="align-default">
<img alt="Pull position from molecular dynamics simulation in GROMACS" class="only-light" src="../../_images/pull-position-light.png" />
</figure>
<figure class="align-default">
<img alt="Pull position from molecular dynamics simulation in GROMACS" class="only-dark" src="../../_images/pull-position-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Distance between the two pulled groups <em>End1</em> and <em>End2</em> along the
<em>x</em> direction, <span class="math notranslate nohighlight">\(\Delta x\)</span>,
as a function of time <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div>
<p>It can be seen from the evolution of the distance between the groups,
<span class="math notranslate nohighlight">\(\Delta x\)</span>, that the system reaches its equilibrium state after
approximately 20 pico-seconds.</p>
<p>Let us probe the effect of the stretching on the structure of the PEG
by remeasuring the dihedral angle values:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mk_angndx<span class="w"> </span>-s<span class="w"> </span>stretching.tpr<span class="w"> </span>-hyd<span class="w"> </span>no<span class="w"> </span>-type<span class="w"> </span>dihedral
gmx<span class="w"> </span>angle<span class="w"> </span>-n<span class="w"> </span>angle.ndx<span class="w">  </span>-f<span class="w"> </span>stretching-centered.xtc<span class="w"> </span>-od<span class="w"> </span>dihedral-distribution.xvg<span class="w"> </span>-binwidth<span class="w"> </span><span class="m">0</span>.25<span class="w"> </span>-type<span class="w"> </span>dihedral<span class="w"> </span>-b<span class="w"> </span><span class="m">20</span>
</pre></div>
</div>
<p>Select 1 for the O-C-C-O dihedral. Here the option <em>-b 20</em> is used to disregard
the first 20 pico-seconds of the simulation during which the PEG has not
reach is final length.</p>
<figure class="align-default">
<img alt="Angular distribution from molecular dynamics simulation in GROMACS" class="only-light" src="../../_images/comparison-dihedral-distribution-light.png" />
</figure>
<figure class="align-default">
<img alt="Angular distribution from molecular dynamics simulation in GROMACS" class="only-dark" src="../../_images/comparison-dihedral-distribution-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Angular distribution for the O-C-C-O dihedral of the PEG molecules,
comparing the unstretched (cyan) and stretched case (orange).</p>
</div>
<p>The change in dihedral angles disribution reveals a configurational change of
the polymer induced by the forcing. This transition is called gauche-trans,
where <em>gauche</em> and <em>trans</em> refer to possible states
for the PEG monomer <span id="id2">[<a class="reference internal" href="../../non-tutorials/bibliography.html#id3" title="Kurt Binder. Monte Carlo and molecular dynamics simulations in polymer science. Oxford University Press, 1995.">26</a>, <a class="reference internal" href="../../non-tutorials/bibliography.html#id48" title="Susanne Liese, Manuel Gensler, Stefanie Krysiak, Richard Schwarzl, Andreas Achazi, Beate Paulus, Thorsten Hugel, Jürgen P Rabe, and Roland R Netz. Hydration effects turn a highly stretched polymer from an entropic into an energetic spring. ACS nano, 11(1):702–712, 2017.">27</a>]</span>.</p>
<figure class="align-default">
<img alt="Illustration of the gauche (left) and trans (right) states of the PEG polymer." src="../../_images/gauche-trans.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Illustration of the gauche (left) and trans (right) states of the
PEG polymer.</p>
</div>
<p>You can access all the input scripts and data files that
are used in these tutorials from <a href="https://github.com/gromacstutorials/gromacstutorials-inputs" target="_blank">GitHub</a>.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../level3/solvation-energy.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Solvation energy</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../level1/protein-in-electrolyte.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Protein in electrolyte</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Stretching a polymer</a><ul>
<li><a class="reference internal" href="#prepare-the-peg-molecule">Prepare the PEG molecule</a></li>
<li><a class="reference internal" href="#solvate-the-peg-molecule">Solvate the PEG molecule</a></li>
<li><a class="reference internal" href="#equilibrate-the-peg-water-system">Equilibrate the PEG-water system</a></li>
<li><a class="reference internal" href="#stretch-on-the-polymer">Stretch on the polymer</a><ul>
<li><a class="reference internal" href="#the-index-file">The index file</a></li>
<li><a class="reference internal" href="#the-input-file">The input file</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>